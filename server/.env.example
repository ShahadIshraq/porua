# Porua Server Configuration
# Copy this file to .env and customize the values

# =============================================================================
# Server Configuration
# =============================================================================

# Server port (default: 3000)
# PORT=3000

# =============================================================================
# TTS Pool Configuration
# =============================================================================

# Number of TTS engines in the pool (default: 2)
# Higher values allow more concurrent requests but use more memory
TTS_POOL_SIZE=2

# =============================================================================
# Authentication Configuration
# =============================================================================

# Path to API keys file (one key per line)
# If not set, will check default locations:
#   - ./api_keys.txt
#   - ~/.porua/api_keys.txt
#   - /etc/porua/api_keys.txt
# Leave empty to disable authentication
# TTS_API_KEY_FILE=./api_keys.txt

# =============================================================================
# Rate Limiting Configuration
# =============================================================================

# Rate limiting mode (default: auto)
# Options:
#   - auto: per-key if auth enabled, per-ip otherwise (RECOMMENDED)
#   - per-key: rate limit by API key (requires authentication)
#   - per-ip: rate limit by IP address
#   - disabled: no rate limiting (NOT RECOMMENDED for production)
RATE_LIMIT_MODE=auto

# -----------------------------------------------------------------------------
# Authenticated Rate Limits (when using API keys)
# -----------------------------------------------------------------------------

# Maximum requests per second per API key (default: 10)
RATE_LIMIT_AUTHENTICATED_PER_SECOND=10

# Maximum burst size per API key (default: 20)
# This is the number of requests that can be made immediately
# before rate limiting kicks in
RATE_LIMIT_AUTHENTICATED_BURST_SIZE=20

# -----------------------------------------------------------------------------
# Unauthenticated Rate Limits (when NOT using API keys)
# -----------------------------------------------------------------------------

# Maximum requests per second per IP address (default: 5)
# More restrictive than authenticated to prevent abuse
RATE_LIMIT_UNAUTHENTICATED_PER_SECOND=5

# Maximum burst size per IP address (default: 10)
# More restrictive than authenticated to prevent abuse
RATE_LIMIT_UNAUTHENTICATED_BURST_SIZE=10

# -----------------------------------------------------------------------------
# Legacy Configuration (for backward compatibility)
# -----------------------------------------------------------------------------
# These set BOTH authenticated and unauthenticated limits if the specific
# variables above are not set
# RATE_LIMIT_PER_SECOND=10
# RATE_LIMIT_BURST_SIZE=20

# =============================================================================
# Logging Configuration
# =============================================================================

# Log directory (default: auto-detect based on platform/installation)
# - Linux system: /var/log/porua
# - Linux user: ~/.local/porua/logs
# - macOS system: /var/log/porua
# - macOS user: ~/Library/Logs/Porua
# - Windows system: C:\ProgramData\Porua\logs
# - Windows user: %LOCALAPPDATA%\Porua\logs
# PORUA_LOG_DIR=/custom/path/to/logs

# Console log level (default: porua_server=info,ort=warn,kokoros=warn)
# Options: error, warn, info, debug, trace
# Examples:
#   RUST_LOG=debug                    # Debug logs for all modules
#   RUST_LOG=porua_server=debug       # Debug logs for porua_server only
#   RUST_LOG=info                     # Info logs for everything
RUST_LOG=porua_server=info,ort=warn,kokoros=warn

# File log level (default: debug)
# This controls the verbosity of logs written to files
# PORUA_FILE_LOG_LEVEL=debug

# Enable access logging (default: true)
# Access logs track all HTTP requests/responses
# LOG_ACCESS_ENABLED=true

# Enable application logging (default: true)
# Application logs track server events, errors, and debugging info
# LOG_APPLICATION_ENABLED=true

# Log format (default: json)
# Options: json, pretty, compact
# JSON format is recommended for production (easy parsing)
# LOG_FORMAT=json

# Log rotation size in MB (default: 50)
# Logs are rotated when they reach this size OR daily (whichever comes first)
# LOG_MAX_SIZE_MB=50

# Log retention in days (default: 30)
# Logs older than this are automatically deleted
# LOG_RETENTION_DAYS=30

# Max total log directory size in MB (default: 1000)
# If total log directory exceeds this, oldest files are deleted
# This prevents disk space exhaustion
# LOG_MAX_TOTAL_SIZE_MB=1000

# Enable log compression (default: true)
# Rotated logs are compressed with gzip (~10:1 compression ratio)
# LOG_COMPRESSION=true

# Enable background cleanup task (default: true)
# Automatically compresses and deletes old logs
# LOG_ENABLE_CLEANUP=true

# Log slow requests (default: true)
# Requests exceeding the threshold are logged as warnings
# LOG_SLOW_REQUESTS=true

# Slow request threshold in milliseconds (default: 5000)
# Requests taking longer than this are considered slow
# LOG_SLOW_REQUEST_THRESHOLD_MS=5000

# =============================================================================
# Model Configuration (Advanced)
# =============================================================================

# TTS Model Directory (REQUIRED for packaged installations)
# This should point to the directory containing kokoro-v1.0.onnx and voices-v1.0.bin
# When installed via install.sh, this is automatically configured
#
# For user installation: ~/.local/porua/models
# For system installation: /usr/local/porua/models
# For development: ./models (relative to project root)
# TTS_MODEL_DIR=/path/to/models

# TTS Samples Directory (Optional - for voice preview samples)
# This should point to the directory containing voice sample WAV files
# If not set, the server will search standard locations automatically:
#   - /usr/local/porua/samples (system installation)
#   - ~/.local/porua/samples (user installation)
#   - ./samples (development)
# Only set this if you want to override the default search behavior
# TTS_SAMPLES_DIR=/path/to/samples

# eSpeak-ng Data Directory (REQUIRED for text phonemization)
# IMPORTANT: Must point to the PARENT directory that CONTAINS the espeak-ng-data subdirectory
#
# For packaged installation: /path/to/share/ (which contains share/espeak-ng-data/)
# For system espeak-ng:
#   - Linux: /usr/share/ (contains espeak-ng-data subdirectory)
#   - macOS Homebrew: /opt/homebrew/share/ (contains espeak-ng-data subdirectory)
# When installed via install.sh, this is automatically configured
#
# Example: If espeak-ng-data is at /usr/local/porua/share/espeak-ng-data/
#          Then set: PIPER_ESPEAKNG_DATA_DIRECTORY=/usr/local/porua/share/
# PIPER_ESPEAKNG_DATA_DIRECTORY=/path/to/share/

# Custom model path (deprecated - use TTS_MODEL_DIR instead)
# KOKORO_MODEL_PATH=/path/to/model

# Custom voices path (deprecated - use TTS_MODEL_DIR instead)
# KOKORO_VOICES_PATH=/path/to/voices

# =============================================================================
# Request Timeout Configuration
# =============================================================================

# Maximum time (in seconds) to wait for a TTS request to complete (default: 30)
# Increase this for very long text inputs
# REQUEST_TIMEOUT_SECONDS=30
