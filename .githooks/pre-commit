#!/bin/bash

# Pre-commit hook to run Rust tests
# This hook prevents commits if tests fail

set -e

echo "Running server tests before commit..."
echo ""

# Run cargo test for the server
if cargo test --manifest-path server/Cargo.toml --quiet; then
    echo ""
    echo "✓ All tests passed! Proceeding with commit."
    exit 0
else
    echo ""
    echo "✗ Tests failed! Please fix the failing tests before committing."
    echo ""
    echo "To run tests manually:"
    echo "  cargo test --manifest-path server/Cargo.toml"
    echo ""
    echo "To skip this hook (not recommended):"
    echo "  git commit --no-verify"
    exit 1
fi
